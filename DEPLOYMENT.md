# Руководство по развертыванию

## Развертывание на GitHub

### 1. Подготовка репозитория
```bash
# Инициализация git (если еще не сделано)
git init

# Добавление всех файлов
git add .

# Первый коммит
git commit -m "Initial commit: Telegram Economic Simulation Bot"

# Добавление удаленного репозитория
git remote add origin https://github.com/yourusername/telegram-economic-bot.git

# Отправка в GitHub
git push -u origin main
```

### 2. Настройка секретов GitHub
В настройках репозитория (Settings > Secrets and variables > Actions) добавьте:
- `TELEGRAM_BOT_TOKEN` - Токен вашего Telegram бота
- `DATABASE_URL` - URL подключения к PostgreSQL базе данных

### 3. Локальное развертывание

#### Требования
- Python 3.11+
- PostgreSQL
- Telegram Bot Token

#### Шаги установки
1. Клонируйте репозиторий:
```bash
git clone https://github.com/yourusername/telegram-economic-bot.git
cd telegram-economic-bot
```

2. Создайте виртуальное окружение:
```bash
python -m venv venv
source venv/bin/activate  # Linux/Mac
# или
venv\Scripts\activate  # Windows
```

3. Установите зависимости:
```bash
pip install flask flask-sqlalchemy psycopg2-binary python-dotenv python-telegram-bot sqlalchemy
```

4. Настройте переменные окружения:
```bash
# Создайте файл .env
echo "TELEGRAM_BOT_TOKEN=your_bot_token_here" > .env
echo "DATABASE_URL=postgresql://user:password@localhost/dbname" >> .env
```

5. Запустите бота:
```bash
python main.py
```

## Развертывание на облачных платформах

### Heroku
1. Создайте приложение Heroku
2. Добавьте PostgreSQL addon
3. Установите переменные окружения
4. Развертывайте через Git

### Railway
1. Подключите GitHub репозиторий
2. Добавьте PostgreSQL сервис
3. Настройте переменные окружения
4. Автоматическое развертывание

### DigitalOcean
1. Создайте Droplet с Ubuntu
2. Установите Python, PostgreSQL, nginx
3. Настройте systemd для автозапуска
4. Настройте reverse proxy через nginx

## Переменные окружения

### Обязательные
- `TELEGRAM_BOT_TOKEN` - Токен Telegram бота
- `DATABASE_URL` - URL PostgreSQL базы данных

### Опциональные
- `FLASK_SECRET_KEY` - Секретный ключ Flask (по умолчанию генерируется)
- `LOG_LEVEL` - Уровень логирования (DEBUG, INFO, WARNING, ERROR)
- `MAX_ENERGY` - Максимальная энергия игрока (по умолчанию 100)
- `ENERGY_REGEN_RATE` - Скорость восстановления энергии (по умолчанию 1/минуту)

## Мониторинг и логи

### Логирование
Бот создает подробные логи всех операций:
- Действия игроков
- Экономические транзакции
- Системные события
- Ошибки и исключения

### Мониторинг производительности
- Статистика пользователей в базе данных
- Мониторинг активности через логи
- Отслеживание использования ресурсов

## Безопасность

### Рекомендации
- Никогда не храните секреты в коде
- Используйте HTTPS для всех соединений
- Регулярно обновляйте зависимости
- Мониторьте подозрительную активность
- Делайте резервные копии базы данных

### Защита базы данных
- Используйте сильные пароли
- Ограничьте сетевой доступ
- Регулярные резервные копии
- Мониторинг производительности

## Масштабирование

### Горизонтальное масштабирование
- Несколько экземпляров бота с балансировкой нагрузки
- Разделение базы данных (sharding)
- Кэширование часто используемых данных

### Вертикальное масштабирование
- Увеличение ресурсов сервера
- Оптимизация запросов к базе данных
- Индексирование таблиц

## Решение проблем

### Частые проблемы
1. **Бот не отвечает** - Проверьте токен и интернет соединение
2. **Ошибки базы данных** - Убедитесь что PostgreSQL запущен
3. **Медленная работа** - Проверьте индексы и оптимизируйте запросы

### Диагностика
- Проверьте логи приложения
- Мониторьте использование ресурсов
- Тестируйте соединения с внешними сервисами